<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hikayeler</title>
    <link rel="stylesheet" href="~/css/Index.css" />
</head>
<body>
    <div class="story-container">
        <table class="story-table">
            <thead>
                <tr>
                    <th>Hikaye Adı</th>
                    <th>Bölüm Sayısı</th>
                    <th>İşlem</th>
                    <th>Devam Et</th>
                    <th>Puan</th>
                </tr>
            </thead>
            <tbody id="storyBody">
                <!-- JavaScript ile doldurulacak -->
            </tbody>
        </table>
    </div>

    <script>
        const stories = [
            { id: 1, name: "Ali'nin Macerası", chapterCount: 5 },
            { id: 2, name: "Ayşe'nin Yolculuğu", chapterCount: 3 },
            { id: 3, name: "Gizemli Orman", chapterCount: 7 }
        ];

        const tbody = document.getElementById("storyBody");

        stories.forEach(story => {
            const row = document.createElement("tr");

            const nameCell = document.createElement("td");
            nameCell.textContent = story.name;

            const chapterCell = document.createElement("td");
            chapterCell.textContent = story.chapterCount;

            // Gör Butonu
            const viewCell = document.createElement("td");
            const viewForm = document.createElement("form");
            viewForm.method = "post";
            viewForm.action = "/Home/WatchStory";

            const viewInput = document.createElement("input");
            viewInput.type = "hidden";
            viewInput.name = "id";
            viewInput.value = story.id;

            const viewButton = document.createElement("button");
            viewButton.type = "submit";
            viewButton.classList.add("view-btn");
            viewButton.textContent = "Gör";

            viewForm.appendChild(viewInput);
            viewForm.appendChild(viewButton);
            viewCell.appendChild(viewForm);

            // Devam Et Butonu
            const continueCell = document.createElement("td");
            const continueForm = document.createElement("form");
            continueForm.method = "post";
            continueForm.action = "/Home/ContinueStory";

            const continueInput = document.createElement("input");
            continueInput.type = "hidden";
            continueInput.name = "id";
            continueInput.value = story.id;

            const continueButton = document.createElement("button");
            continueButton.type = "submit";
            continueButton.classList.add("continue-btn");
            continueButton.textContent = "Devam Et";

            continueForm.appendChild(continueInput);
            continueForm.appendChild(continueButton);
            continueCell.appendChild(continueForm);

            // Yıldız Puanlama
            const ratingCell = document.createElement("td");
            ratingCell.classList.add("rating");

            for (let i = 1; i <= 5; i++) {
                const star = document.createElement("span");
                star.classList.add("star");
                star.dataset.value = i;
                star.innerHTML = "&#9733;"; // Unicode yıldız ★
                star.addEventListener("mouseover", function () {
                    highlightStars(ratingCell, i);
                });
                star.addEventListener("mouseout", function () {
                    resetStars(ratingCell);
                });
                star.addEventListener("click", function () {
                    selectStars(ratingCell, i);
                    console.log(`Hikaye ID ${story.id} için verilen puan: ${i}`);
                    // AJAX ile backend'e gönderilebilir
                });
                ratingCell.appendChild(star);
            }

            row.appendChild(nameCell);
            row.appendChild(chapterCell);
            row.appendChild(viewCell);
            row.appendChild(continueCell);
            row.appendChild(ratingCell);

            tbody.appendChild(row);
        });

        function highlightStars(cell, count) {
            const stars = cell.querySelectorAll(".star");
            stars.forEach((star, index) => {
                if (index < count) {
                    star.classList.add("hovered");
                } else {
                    star.classList.remove("hovered");
                }
            });
        }

        function resetStars(cell) {
            const stars = cell.querySelectorAll(".star");
            stars.forEach(star => star.classList.remove("hovered"));
        }

        function selectStars(cell, count) {
            const stars = cell.querySelectorAll(".star");
            stars.forEach((star, index) => {
                if (index < count) {
                    star.classList.add("selected");
                } else {
                    star.classList.remove("selected");
                }
            });
        }
    </script>
</body>
</html>
