<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hikaye Ekleme</title>
    <link rel="stylesheet" href="~/css/AdminPanel.css" />
</head>
<body>
    <div class="story-container">
        <!-- Ekleme Formu -->
        <form id="storyForm" class="story-form">
            <input type="text" id="username" placeholder="Hikaye Adı" required />
            <input type="text" id="konu" placeholder="Hikayenin Konusu" required />
            <button type="submit">Ekle</button>
        </form>

        <!-- Hikaye Tablosu -->
        <table class="story-table">
            <thead>
                <tr>
                    <th>Hikaye Adı</th>
                    <th>Hikayenin Konusu</th>
                    <th>Düzenle</th>
                    <th>Sil</th>
                    <th>Bölüm Ekle</th>
                </tr>
            </thead>
            <tbody id="storyBody">
                <tr>
                    <td>Ali</td>
                    <td>Macera</td>
                    <td>
                        <form method="post" action="/Home/AdminPanelEdit">
                            <input type="hidden" name="name" value="Ali" />
                            <button type="submit" class="edit-btn">Düzenle</button>
                        </form>
                    </td>
                    <td><button class="delete-btn">Sil</button></td>
                    <td>
                        <form method="get" action="/Home/AddChapter">
                            <button type="submit" class="add-chapter-btn">Bölüm Ekle</button>
                        </form>
                    </td>
                </tr>
                <tr>
                    <td>Ayşe</td>
                    <td>Fantastik</td>
                    <td>
                        <form method="post" action="/Home/AdminPanelEdit">
                            <input type="hidden" name="name" value="Ayşe" />
                            <button type="submit" class="edit-btn">Düzenle</button>
                        </form>
                    </td>
                    <td><button class="delete-btn">Sil</button></td>
                    <td>
                        <form method="get" action="/Home/AddChapter">
                            <button type="submit" class="add-chapter-btn">Bölüm Ekle</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- JavaScript -->
    <script>
        const form = document.getElementById("storyForm");
        const tbody = document.getElementById("storyBody");

        form.addEventListener("submit", function (e) {
            e.preventDefault();

            const username = document.getElementById("username").value.trim();
            const konu = document.getElementById("konu").value.trim();

            if (username && konu) {
                const row = document.createElement("tr");

                // Hikaye Adı
                const userCell = document.createElement("td");
                userCell.textContent = username;

                // Konu
                const konuCell = document.createElement("td");
                konuCell.textContent = konu;

                // Düzenle
                const editCell = document.createElement("td");
                const editForm = document.createElement("form");
                editForm.method = "post";
                editForm.action = "/Home/AdminPanelEdit";

                const hiddenInput = document.createElement("input");
                hiddenInput.type = "hidden";
                hiddenInput.name = "name";
                hiddenInput.value = username;

                const editBtn = document.createElement("button");
                editBtn.type = "submit";
                editBtn.classList.add("edit-btn");
                editBtn.textContent = "Düzenle";

                editForm.appendChild(hiddenInput);
                editForm.appendChild(editBtn);
                editCell.appendChild(editForm);

                // Sil
                const deleteCell = document.createElement("td");
                const deleteBtn = document.createElement("button");
                deleteBtn.textContent = "Sil";
                deleteBtn.classList.add("delete-btn");
                deleteBtn.addEventListener("click", () => {
                    tbody.removeChild(row);
                });
                deleteCell.appendChild(deleteBtn);

                // Bölüm Ekle
                const chapterCell = document.createElement("td");
                const chapterForm = document.createElement("form");
                chapterForm.method = "get";
                chapterForm.action = "/Home/AddChapter";

                const chapterBtn = document.createElement("button");
                chapterBtn.type = "submit";
                chapterBtn.textContent = "Bölüm Ekle";
                chapterBtn.classList.add("chapter-btn");

                chapterForm.appendChild(chapterBtn);
                chapterCell.appendChild(chapterForm);

                // Satıra ekle
                row.appendChild(userCell);
                row.appendChild(konuCell);
                row.appendChild(editCell);
                row.appendChild(deleteCell);
                row.appendChild(chapterCell);

                tbody.appendChild(row);
                form.reset();
            }
        });

        // Mevcut sil butonlarını çalıştır
        document.querySelectorAll(".delete-btn").forEach(button => {
            button.addEventListener("click", (e) => {
                const row = e.target.closest("tr");
                if (row) row.remove();
            });
        });
    </script>
</body>
</html>
